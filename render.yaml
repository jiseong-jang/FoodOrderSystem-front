services:
  - type: web
    name: mrdinner-backend
    env: java
    buildCommand: cd backend && mvn clean package -DskipTests
    startCommand: cd backend && java -jar target/mrdinner-backend-1.0.0.jar
    envVars:
      - key: SPRING_DATASOURCE_URL
        sync: false
      - key: SPRING_DATASOURCE_USERNAME
        sync: false
      - key: SPRING_DATASOURCE_PASSWORD
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: FRONTEND_URL
        sync: false
      - key: PORT
        fromService:
          type: web
          name: mrdinner-backend
          property: port

  - type: web
    name: mrdinner-voice-api
    env: python
    buildCommand: cd voice-order-fastapi && pip install -r requirements.txt
    startCommand: cd voice-order-fastapi && uvicorn app.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: VOICE_ORDER_CLIENT_ORIGIN
        sync: false
      - key: VOICE_ORDER_MODEL_PRESET
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: VOICE_ORDER_CHAT_MODEL
        sync: false
      - key: VOICE_ORDER_HF_ENDPOINT
        sync: false
      - key: VOICE_ORDER_HF_MODEL
        sync: false
      - key: VOICE_ORDER_HF_TOKEN
        sync: false
      - key: PORT
        fromService:
          type: web
          name: mrdinner-voice-api
          property: port

